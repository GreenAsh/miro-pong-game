<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="https://realtimeboard.com/app/static/rtb.uikit.css">
	<script src="https://realtimeboard.com/app/static/rtb.sdk.1.0.js"></script>

	<style>
		.rtb-sidebar-caption {
			font-size: 14px;
			font-weight: bold;
			color: rgba(0, 0, 0, 0.8);
			padding: 24px 0 0 24px;
		}

		.actions {
			padding: 20px 24px 0 24px;
		}

		button {
			height: 32px;
			border-radius: 4px;
			font-size: 12px;
			font-weight: bold;
			line-height: 30px;
			text-align: center;
			color: #fff;
			min-width: 65px;
			background-color: #2a79ff;
			overflow: hidden;
			text-overflow: ellipsis;
		}
	</style>
	<script src="global.js"></script>
	<script src="setup.js"></script>
</head>

<body>
	<div class="rtb-sidebar-caption">Ping-pong</div>
	<div class="actions">
		<center>
			<br><br>
			<button onclick="run()" style="width: 120px;">Play!</button>
			<br><br>
			<h2 id="controls" style="display:none;">Use up/down arrows and A/Z keys to control pad</h2>
			<h2 id="you-are-dead" style="display:none; background-color: red;">You are dead, reopen sidebar and click 'Play'!</h2>
			<h2 id="click-for-focus" style="display:none;">Click on sidebar <br>to control pad</h2>
		</center>
	</div>
	<script>
		'use strict'

		async function run() {
			setUp()

			window.addEventListener('keydown', (e) => {
				switch (e.keyCode) {
					case 37:
						movePad('left')
						break
					case 39:
						movePad('right')
						break
				}
				e.preventDefault()
				e.stopPropagation()
			})

			window.addEventListener('keyup', (e) => {
				switch (e.keyCode) {
					case 37:
					case 39:
						stopMovePad()
						break
				}
				e.preventDefault()
				e.stopPropagation()
			})

			requestAnimationFrame(tick)

			function tick() {
				requestAnimationFrame(tick)
			}
		}

		function movePad(direction) {
			switch (direction) {
				case 'left':
					currentPlayer.movingLeft = true
					currentPlayer.movingRight = false
					break
				case 'right':
					currentPlayer.movingLeft = false
					currentPlayer.movingRight = true
					break
			}
		}

		function stopMovePad() {
			currentPlayer.movingLeft = false
			currentPlayer.movingRight = false
		}
	</script>
</body>

</html>